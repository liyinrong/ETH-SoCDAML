
# File generated by Go version O-2018.09#f5599cac26#190121, Tue May 28 10:45:22 2024
# Copyright 2014-2018 Synopsys, Inc. All rights reserved.
# go -B -I../lib -F -D__tct_patch__=300 -Verilog -otmicro_vlog -cgo_options.cfg -Itmicro_vlog/tmp_pdg -updg -updg_controller tmicro




# THISDIR specifies path to the directory of this Makefile
THISDIR = $(shell dirname $(realpath $(lastword $(MAKEFILE_LIST))))
MAKEDIR = $(THISDIR)

LIBDIR    = $(THISDIR)/tmicro/go_bin
LIBDIR_TB = $(THISDIR)/test_bench/go_tb_bin

SOURCES_RTL =  \
	tmicro/controller/controller.v \
	tmicro/controller/jtag_scan_register.v \
	tmicro/controller/debug_controller.v \
	tmicro/controller/jtag_interface.v \
	tmicro/controller/decoder.v \
	tmicro/mux/mux_pm_addr.v \
	tmicro/mux/mux_pm_write.v \
	tmicro/mux/mux_dm_addr.v \
	tmicro/mux/mux_dm_write.v \
	tmicro/mux/mux_rte1.v \
	tmicro/mux/mux_lfw.v \
	tmicro/mux/mux_lcw.v \
	tmicro/mux/mux_iew.v \
	tmicro/mux/mux1.v \
	tmicro/mux/mux_wbus.v \
	tmicro/mux/mux_ag1p.v \
	tmicro/mux/mux_ag1m.v \
	tmicro/mux/mux_trgt.v \
	tmicro/mux/mux_offs.v \
	tmicro/mux/mux_tcc.v \
	tmicro/mux/mux2.v \
	tmicro/mux/mux3.v \
	tmicro/mux/mux_cbus.v \
	tmicro/mux/mux___pm_addr_pipe_w.v \
	tmicro/mux/mux___dm_addr_pipe_w.v \
	tmicro/mux/mux___LC_lcw_wad.v \
	tmicro/pipe/pipe1.v \
	tmicro/pipe/pipe2.v \
	tmicro/reg/reg_R.v \
	tmicro/reg/reg_LR.v \
	tmicro/reg/reg_SP.v \
	tmicro/reg/reg_PC.v \
	tmicro/reg/reg_LF.v \
	tmicro/reg/reg_LS.v \
	tmicro/reg/reg_LE.v \
	tmicro/reg/reg_LC.v \
	tmicro/reg/reg_CND.v \
	tmicro/reg/reg_CB.v \
	tmicro/reg/reg_IE.v \
	tmicro/reg/reg_SRa.v \
	tmicro/reg/reg_SRb.v \
	tmicro/reg/reg_IM.v \
	tmicro/reg/reg_ILR.v \
	tmicro/reg/reg_ISR.v \
	tmicro/reg/reg_ocd_addr.v \
	tmicro/reg/reg_ocd_data.v \
	tmicro/reg/reg_ocd_instr.v \
	tmicro/mem/interrupt_io.v \
	tmicro/mem/mem_PM.v \
	tmicro/mem/mem_DM.v \
	tmicro/prim/dlflg.v \
	tmicro/prim/ocd_addr_incr.v \
	tmicro/prim/alu.v \
	tmicro/prim/sh.v \
	tmicro/prim/mul.v \
	tmicro/prim/ag1.v \
	tmicro/tmicro.v
SOURCES_TB =  \
	test_bench/clock_gen.v \
	test_bench/jtag_tap_controller.v \
	test_bench/jtag_emulator.v \
	test_bench/tb_irq_inp.v \
	test_bench/tb_mem_PM.v \
	test_bench/tb_mem_DM.v \
	test_bench/test_bench.v

SIM_INSTALL = $(dir $(shell which vcs))
CHESSDE_INSTALL  = $(dir $(shell which chessde))
GO_INCLUDE  = $(CHESSDE_INSTALL)/../../chessdir/godir/include
CHESSDIR_INCLUDE  = $(CHESSDE_INSTALL)/../../chessdir
CHECKERS_INCLUDE  = $(CHESSDE_INSTALL)/../../chessdir/checkersdir/include
VPI_INCLUDE = $(SIM_INSTALL)/../include
JTAG_EMU = jtag_emulator_vpi.so
CC = g++
LD = g++
CCFLAGS = -m32 -c -fPIC -std=c++11 -g -DVCS -DOLD_VCS_VHPI
LDFLAGS = -m32 -shared -fPIC
GCCLIB_PATH = $(dir $(realpath $(shell which g++)))/../lib
ifdef LD_LIBRARY_PATH
    export LD_LIBRARY_PATH := $(GCCLIB_PATH):$(LD_LIBRARY_PATH)
else
    export LD_LIBRARY_PATH := $(GCCLIB_PATH)
endif

default: all

all: elab
	$(THISDIR)/simv +warn=noSTASKW_CO -gui

dirs:
	@if [ ! -d $(LIBDIR) ];    then mkdir -p $(LIBDIR); fi
	@if [ ! -d $(LIBDIR_TB) ]; then mkdir -p $(LIBDIR_TB); fi

$(JTAG_EMU): $(GO_INCLUDE)/jtag_emulator_vpi.cpp
	cd $(THISDIR) && $(CC) $(CCFLAGS) -I $(VPI_INCLUDE) -I $(GO_INCLUDE) -I $(CHESSDIR_INCLUDE) -I $(CHECKERS_INCLUDE) $(GO_INCLUDE)/jtag_emulator_vpi.cpp; \
	cd $(THISDIR) && $(CC) $(CCFLAGS) -I $(VPI_INCLUDE) -I $(CHESSDIR_INCLUDE) -I $(CHECKERS_INCLUDE) $(CHECKERS_INCLUDE)/jtag_socket.cpp; \
	cd $(THISDIR) && $(LD) $(LDFLAGS) -o $(JTAG_EMU) jtag_emulator_vpi.o jtag_socket.o -Wl,-rpath $(GCCLIB_PATH);

analyze: dirs
	cd $(THISDIR) && vlogan -nc -kdb -work tmicro_lib +v2k +incdir+tmicro/prim  $(SOURCES_RTL)
	cd $(THISDIR) && vlogan -nc -kdb -work tmicro_tb_lib +v2k +incdir+tmicro/prim  $(SOURCES_TB)

elab: analyze $(JTAG_EMU)
	cd $(THISDIR) && vcs -debug -time_res 1ps -o simv tmicro_tb_lib.test_bench -load $(THISDIR)/$(JTAG_EMU):jtag_vpi_register_tfs

dve:
	$(THISDIR)/simv +warn=noSTASKW_CO -gui=dve

dve_dumpall:
	$(THISDIR)/simv +warn=noSTASKW_CO -do gen_dump.tcl -gui=dve

verdi:
	$(THISDIR)/simv +warn=noSTASKW_CO -gui=verdi

verdi_dumpall:
	$(THISDIR)/simv +warn=noSTASKW_CO -do gen_dump.tcl -gui=verdi

sim:
	@echo No \'hdl_simulate_command\' option provided; \'make sim\' has no effect.

cli: elab
	$(THISDIR)/simv +warn=noSTASKW_CO -ucli

run:
	$(THISDIR)/simv +warn=noSTASKW_CO 

rcd:
	$(THISDIR)/simv +warn=noSTASKW_CO -ucli -do $(THISDIR)/gen_rcd.tcl -licqueue

ext_stop:
	$(THISDIR)/simv +warn=noSTASKW_CO -ucli -do $(THISDIR)/gen_ext_stop.tcl -licqueue

saif: elab
	$(THISDIR)/simv +warn=noSTASKW_CO -ucli -do $(THISDIR)/gen_saif.tcl -licqueue

clean:
	@cd $(THISDIR) && rm -rf tmicro/go_bin
	@cd $(THISDIR) && rm -rf test_bench/go_tb_bin
	@cd $(THISDIR) && rm -rf csrc simv*
	@cd $(THISDIR) && rm -rf DVEfiles inter.vpd*
	@cd $(THISDIR) && rm -rf .restartSimSession.tcl*
	@cd $(THISDIR) && rm -rf .synopsys_dve_rebuild.tcl
	@cd $(THISDIR) && rm -rf .vlogansetup.args
	@cd $(THISDIR) && rm -rf novas.* novas_dump.*
	@cd $(THISDIR) && rm -rf inter.fsdb
	@cd $(THISDIR) && rm -rf verdiLog
	@cd $(THISDIR) && rm -rf ucli.key
	@cd $(THISDIR) && rm -rf jtag_socket*.o
	@cd $(THISDIR) && rm -rf jtag_emulator*.o
	@cd $(THISDIR) && rm -rf jtag_emulator*.so
	@cd $(THISDIR) && rm -rf libjtag_emulator*.so

test:
	@echo This model has I/O-Interfaces, use "\'iss -b <application>\'" to generate the memory content files.
